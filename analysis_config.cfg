# =============================================================================
# ADAPTIVE FLOW - LLM ANALYSIS CONFIGURATION
# =============================================================================
# Configure the print analysis system that provides AI-powered tuning suggestions.
#
# SETUP:
#   1. Choose a provider below (github is free and recommended)
#   2. Set your API key
#   3. Run: python3 analyze_print.py
#
# For auto-analysis after every print, see docs/ANALYSIS.md
# =============================================================================

[analysis]
# LLM Provider
# Options: github, ollama, openai, anthropic, gemini, openrouter
provider: github

# API Key (or set environment variable instead)
# GitHub: Generate at https://github.com/settings/tokens (no scopes needed)
# OpenAI: Get from https://platform.openai.com/api-keys
# Anthropic: Get from https://console.anthropic.com/
# Gemini: Get from https://makersuite.google.com/app/apikey
# Ollama: Leave empty (no key needed for local)
api_key: 

# Model override (optional - each provider has a sensible default)
# Examples:
#   github: gpt-4o-mini (default), gpt-4o
#   ollama: llama3.1 (default), mistral, codellama
#   openai: gpt-4o-mini (default), gpt-4o, gpt-4-turbo
#   anthropic: claude-3-haiku-20240307 (default), claude-3-sonnet
#   gemini: gemini-2.0-flash-exp (default), gemini-pro
model: 

# =============================================================================
# AUTO-APPLY SETTINGS
# =============================================================================

# Automatically apply suggestions marked "safe_to_auto_apply"
# Only affects conservative changes that won't cause print failures
auto_apply: false

# Send analysis results to Klipper console
notify_console: true

# =============================================================================
# MOONRAKER INTEGRATION (for auto-analysis after prints)
# =============================================================================

# Moonraker URL (usually localhost)
moonraker_url: http://localhost:7125

# Analysis mode for moonraker_hook.py
# poll: Check print state every 5 seconds (simpler, recommended)
# webhook: Listen for Moonraker notifications (requires moonraker.conf edit)
hook_mode: poll

# Port for webhook listener (only used if hook_mode: webhook)
webhook_port: 7126

# =============================================================================
# LOG SETTINGS
# =============================================================================

# Where print session logs are stored
log_dir: ~/printer_data/logs/adaptive_flow

# Keep this many log files (older ones deleted)
max_log_files: 20

# =============================================================================
# ADVANCED
# =============================================================================

# Include klippy.log analysis (scans for errors during print)
analyze_klippy_log: true

# Max CSV rows to send to LLM (reduces token usage)
max_csv_rows: 100
